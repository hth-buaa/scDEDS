% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/loss_cal.R
\name{loss_cal}
\alias{loss_cal}
\title{Calculate Prediction Loss for a Specific TG-TF Pair}
\usage{
loss_cal(TG_TF, data)
}
\arguments{
\item{TG_TF}{Character. A string identifier for the specific TG-TF pair in the format "TG_<target_gene>~<transcription_factor>_TF" (eg. TG_TP53~JUND_TF).
This is used to extract the appropriate target gene and transcription factor identifiers.}

\item{data}{Data frame. The dataset containing expression values for the TG-TF pair,
typically including columns for TFE, TGA, TGE across multiple time points, and the regulatory strength theta_s.
Typically choose one from three options: training set data, validation set data, or test set data.}
}
\value{
A numeric value representing the mean squared prediction error across all time points for the specified TG-TF pair.
The loss combines prediction errors for:
\itemize{
\item TFE (Transcription Factor Expression)
\item TGA (Target Gene Accessibility)
\item TGE (Target Gene Expression)
}
Lower values indicate better prediction performance.
}
\description{
This function computes the prediction loss (mean squared error) for a specific target gene-transcription factor (TG-TF) pair using optimized model parameters.
It evaluates how well the trained model predicts the expression dynamics of TFE, TGA, and TGE across multiple time points.
}
\details{
The function performs the following operations:
\enumerate{
\item Parameter Extraction: Retrieves optimized parameters from the global variable \code{result_gradient$parameters}
\item TG-TF Identification: Parses the TG-TF identifier to extract target gene and transcription factor names
\item Data Extraction: Extracts TFE, TGA, and TGE expression values across time points
\item Parameter Retrieval: Retrieves all relevant model parameters for the specific TG-TF pair
\item R Function Applications.
\item Hill Function Applications: Computes multiple Hill functions for different regulatory components
\item Loss Computation: Calculates mean squared prediction errors across all time points
}
The loss function incorporates weighted squared errors for TFE, TGA, and TGE predictions, with TFE and TGA errors weighted twice as heavily as TGE errors.
}
\note{
Important considerations:
\itemize{
\item This function assumes the existence of several global variables: \code{result_gradient}, \code{branch_params_names}, \code{tao}, and \code{Tslot_K}
\item The function depends on optimized parameters from a previous training process
\item The TG-TF identifier must follow the specific format for proper parsing
\item The data parameter must contain the required columns with proper naming conventions
\item The function is typically used for model evaluation on validation or test data
}
}
\examples{
\dontrun{
print(loss_cal(TG_TF = "TG_TP53~JUND_TF", data = train_data))
}
}
\seealso{
\code{\link{R_cal}}, \code{\link{Hill_cal}}, \code{\link{S_cal}}
}
